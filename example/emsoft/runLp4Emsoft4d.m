function [lpVer, solveResVer, resNorms] = runLp4Emsoft4d()

clear;
echo on;

% disable warning of `Support of character vectors will be removed in a future release.`
% which is produced by function `monomials`.
warning('off')

% get the problem
[vars, f, eps, theta, psy, zeta] = getLp4Emsoft4dProblem();

x1 = vars(1);
x2 = vars(2);
x3 = vars(3);
x4 = vars(4);

maxIterations = lp4.Lp4Config.DEFAULT_MAX_ITERATION_COUNT;

% degree = 2;
% pLambdaDegree = 1;
% 
% initPhy = 23.35649653+11.9570*x1+5.6366*x2+38.1902*x3+17.9025*x4-6.8542*x3*x4+4.8428*x1*x4-9.4084*x1*x3-50.6959*x1^2-20.7429*x2^2-52.4027*x3^2-49.9831*x4^2-2.9252*x1*x2+0.8951*x2*x3+20.4207*x2*x4;

degree = 4;
pLambdaDegree = 0;

initPhy = (1456664506518763*x1^3)/35184372088832 - (1229607102759911*x1^3*x2)/35184372088832 - (70788537793641*x1^3*x3)/35184372088832 - (800122039889039*x1^3*x4)/35184372088832 - (57048404801029*x1^4)/4398046511104 + (343732950094727*x1^2*x2^2)/35184372088832 - (80095353667629*x1^2*x2*x3)/17592186044416 - (77662936510685*x1^2*x2*x4)/4398046511104 + (2428467770555329*x1^2*x2)/17592186044416 - (2451960525610237*x1^2*x3^2)/35184372088832 - (599214613478781*x1^2*x3*x4)/17592186044416 + (2381343480944733*x1^2*x3)/35184372088832 - (153515761452563*x1^2*x4^2)/8796093022208 + (218435485031767*x1^2*x4)/1099511627776 - (6196374671549713*x1^2)/4398046511104 - (1016333917153121*x1*x2^3)/17592186044416 - (788062989347*x1*x2^2*x3)/1099511627776 + (280892216867083*x1*x2^2*x4)/35184372088832 + (716549168592909*x1*x2^2)/17592186044416 - (3031013953301623*x1*x2*x3^2)/35184372088832 + (383294724592623*x1*x2*x3*x4)/35184372088832 - (1704432403494073*x1*x2*x3)/35184372088832 + (180038862528195*x1*x2*x4^2)/17592186044416 - (169784085730385*x1*x2*x4)/4398046511104 - (5239601283061707*x1*x2)/8796093022208 - (268977893767819*x1*x3^3)/8796093022208 + (268396615257331*x1*x3^2*x4)/35184372088832 + (582643025962055*x1*x3^2)/2199023255552 - (80936438381973*x1*x3*x4^2)/17592186044416 + (310152574761721*x1*x3*x4)/2199023255552 - (217128203918041*x1*x3)/549755813888 + (55296803295769*x1*x4^3)/35184372088832 + (2636730867154585*x1*x4^2)/35184372088832 + (512472530810043*x1*x4)/4398046511104 + (1215199625374027*x1)/4398046511104 - (586904263068637*x2^4)/35184372088832 - (10963622626747*x2^3*x3)/35184372088832 + (38260422674303*x2^3*x4)/17592186044416 - (840282537220445*x2^3)/17592186044416 - (1483265635386071*x2^2*x3^2)/35184372088832 + (26841426818407*x2^2*x3*x4)/8796093022208 - (876534198417553*x2^2*x3)/35184372088832 + (21555790674037*x2^2*x4^2)/4398046511104 - (1755780439315317*x2^2*x4)/35184372088832 - (5556679555283169*x2^2)/17592186044416 - (827538263410793*x2*x3^3)/35184372088832 + (273533693491325*x2*x3^2*x4)/17592186044416 + (4797529890300737*x2*x3^2)/17592186044416 + (1371904256237*x2*x3*x4^2)/137438953472 + (6906503474917467*x2*x3*x4)/35184372088832 - (2097752374524553*x2*x3)/8796093022208 - (7617197945575*x2*x4^3)/4398046511104 + (1454068712061097*x2*x4^2)/17592186044416 + (2856451170165875*x2*x4)/4398046511104 + (7613680662993311*x2)/17592186044416 - (3288636301627249*x3^4)/35184372088832 - (1780150429396209*x3^3*x4)/17592186044416 + (2488663567071659*x3^3)/8796093022208 + (288742461287283*x3^2*x4^2)/35184372088832 + (3871956958608095*x3^2*x4)/8796093022208 - (4183475262066467*x3^2)/1099511627776 + (5077690279*x3*x4^3)/35184372088832 - (111572706752311*x3*x4^2)/4398046511104 - (8530598570493957*x3*x4)/17592186044416 + (1293513618811327*x3)/274877906944 - (596665901819*x4^4)/1099511627776 - (96354187699123*x4^3)/17592186044416 + (1729656353068305*x4^2)/17592186044416 + (5701422646854181*x4)/4398046511104 + 2843445066449639/549755813888;



% run and verify
[lpVer, solveResVer, resNorms] = lp4.runAndVerifyLp4WithIterations1(...
    vars, f, eps, theta, psy, zeta, degree, pLambdaDegree,...
    maxIterations, initPhy);

warning('on')

echo off;
end
